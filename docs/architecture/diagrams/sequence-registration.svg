<?plantuml 1.2026.2beta3?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2803px" preserveAspectRatio="none" style="width:1510px;height:2803px;background:#FFFFFF;" version="1.1" viewBox="0 0 1510 2803" width="1510px" zoomAndPan="magnify"><title>User Registration Flow with Distributed Tracing &amp; Compensating Transaction</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="959.7285" x="278.7046" y="35.4209">User Registration Flow with Distributed Tracing &amp; Compensating Transaction</text><g><title>Individuals API</title><rect fill="#FFFFFF" height="1685.8281" style="stroke:#000000;stroke-width:1;" width="10" x="415.6914" y="210.3047"/></g><g><title>Person Service</title><rect fill="#FFFFFF" height="481.6563" style="stroke:#000000;stroke-width:1;" width="10" x="691.0977" y="429.6328"/></g><g><title>Person Service</title><rect fill="#FFFFFF" height="363.8594" style="stroke:#000000;stroke-width:1;" width="10" x="691.0977" y="2129.1328"/></g><g><title>Person Database</title><rect fill="#FFFFFF" height="235.3281" style="stroke:#000000;stroke-width:1;" width="10" x="970.1563" y="551.1641"/></g><g><title>Person Database</title><rect fill="#FFFFFF" height="205.0625" style="stroke:#000000;stroke-width:1;" width="10" x="970.1563" y="2208.5313"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="177.0625" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1075.3516"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="73.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1346.9453"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="262.4609" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1514.875"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1990.3359"/></g><g><title>Keycloak Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1325.7983" y="1119.6172"/></g><rect fill="#90EE90" height="1728.6328" style="stroke:#000000;stroke-width:1;" width="1489.1377" x="14" y="976.5547"/><rect fill="#FFC0CB" height="750.7891" style="stroke:none;stroke-width:1;" width="1489.1377" x="14" y="1954.3984"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="User" id="part1-lifeline"><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="114.9551" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="118" x2="118" y1="128.9063" y2="2722.1875"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="API" id="part2-lifeline"><g><title>Individuals API</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="416.6914" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="420.6543" x2="420.6543" y1="128.9063" y2="2722.1875"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="PS" id="part3-lifeline"><g><title>Person Service</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="692.0977" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="695.23" x2="695.23" y1="128.9063" y2="2722.1875"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="DB" id="part4-lifeline"><g><title>Person Database</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="971.1563" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="974.7588" x2="974.7588" y1="128.9063" y2="2722.1875"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="KC" id="part5-lifeline"><g><title>Keycloak</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="1092.0127" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1095.5537" x2="1095.5537" y1="128.9063" y2="2722.1875"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="KDB" id="part6-lifeline"><g><title>Keycloak Database</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="1326.7983" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1330.7139" x2="1330.7139" y1="128.9063" y2="2722.1875"/></g></g><g class="participant-lifeline" data-entity-uid="part7" data-qualified-name="Tempo" id="part7-lifeline"><g><title>Tempo</title><rect fill="#000000" fill-opacity="0.00000" height="2593.2813" width="8" x="1448.0103" y="128.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1451.8828" x2="1451.8828" y1="128.9063" y2="2722.1875"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="User" id="part1-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="100" y="125.6045">User</text><ellipse cx="118.9551" cy="60.6094" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M118.9551,68.6094 L118.9551,95.6094 M105.9551,76.6094 L131.9551,76.6094 M118.9551,95.6094 L105.9551,110.6094 M118.9551,95.6094 L131.9551,110.6094" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="User" id="part1-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="100" y="2734.1826">User</text><ellipse cx="118.9551" cy="2746.4844" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M118.9551,2754.4844 L118.9551,2781.4844 M105.9551,2762.4844 L131.9551,2762.4844 M118.9551,2781.4844 L105.9551,2796.4844 M118.9551,2781.4844 L131.9551,2796.4844" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="API" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="116.0742" x="362.6543" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102.0742" x="369.6543" y="117.6045">Individuals API</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="API" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="116.0742" x="362.6543" y="2721.1875"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102.0742" x="369.6543" y="2741.1826">Individuals API</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="PS" id="part3-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="117.7354" x="637.23" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="103.7354" x="644.23" y="117.6045">Person Service</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="PS" id="part3-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="117.7354" x="637.23" y="2721.1875"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="103.7354" x="644.23" y="2741.1826">Person Service</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="DB" id="part4-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="118.7949" x="912.7588" y="125.6045">Person Database</text><path d="M957.1563,76.6094 C957.1563,66.6094 975.1563,66.6094 975.1563,66.6094 C975.1563,66.6094 993.1563,66.6094 993.1563,76.6094 L993.1563,102.6094 C993.1563,112.6094 975.1563,112.6094 975.1563,112.6094 C975.1563,112.6094 957.1563,112.6094 957.1563,102.6094 L957.1563,76.6094" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M957.1563,76.6094 C957.1563,86.6094 975.1563,86.6094 975.1563,86.6094 C975.1563,86.6094 993.1563,86.6094 993.1563,76.6094" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="DB" id="part4-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="118.7949" x="912.7588" y="2734.1826">Person Database</text><path d="M957.1563,2747.4844 C957.1563,2737.4844 975.1563,2737.4844 975.1563,2737.4844 C975.1563,2737.4844 993.1563,2737.4844 993.1563,2747.4844 L993.1563,2773.4844 C993.1563,2783.4844 975.1563,2783.4844 975.1563,2783.4844 C975.1563,2783.4844 957.1563,2783.4844 957.1563,2773.4844 L957.1563,2747.4844" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M957.1563,2747.4844 C957.1563,2757.4844 975.1563,2757.4844 975.1563,2757.4844 C975.1563,2757.4844 993.1563,2757.4844 993.1563,2747.4844" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="KC" id="part5-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="76.918" x="1057.5537" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.918" x="1064.5537" y="117.6045">Keycloak</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="KC" id="part5-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="76.918" x="1057.5537" y="2721.1875"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.918" x="1064.5537" y="2741.1826">Keycloak</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="KDB" id="part6-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="134.1689" x="1260.7139" y="125.6045">Keycloak Database</text><path d="M1312.7983,76.6094 C1312.7983,66.6094 1330.7983,66.6094 1330.7983,66.6094 C1330.7983,66.6094 1348.7983,66.6094 1348.7983,76.6094 L1348.7983,102.6094 C1348.7983,112.6094 1330.7983,112.6094 1330.7983,112.6094 C1330.7983,112.6094 1312.7983,112.6094 1312.7983,102.6094 L1312.7983,76.6094" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1312.7983,76.6094 C1312.7983,86.6094 1330.7983,86.6094 1330.7983,86.6094 C1330.7983,86.6094 1348.7983,86.6094 1348.7983,76.6094" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="KDB" id="part6-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="134.1689" x="1260.7139" y="2734.1826">Keycloak Database</text><path d="M1312.7983,2747.4844 C1312.7983,2737.4844 1330.7983,2737.4844 1330.7983,2737.4844 C1330.7983,2737.4844 1348.7983,2737.4844 1348.7983,2747.4844 L1348.7983,2773.4844 C1348.7983,2783.4844 1330.7983,2783.4844 1330.7983,2783.4844 C1330.7983,2783.4844 1312.7983,2783.4844 1312.7983,2773.4844 L1312.7983,2747.4844" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1312.7983,2747.4844 C1312.7983,2757.4844 1330.7983,2757.4844 1330.7983,2757.4844 C1330.7983,2757.4844 1348.7983,2757.4844 1348.7983,2747.4844" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part7" data-qualified-name="Tempo" id="part7-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="62.2549" x="1420.8828" y="97.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="48.2549" x="1427.8828" y="117.6045">Tempo</text></g><g class="participant participant-tail" data-entity-uid="part7" data-qualified-name="Tempo" id="part7-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="62.2549" x="1420.8828" y="2721.1875"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="48.2549" x="1427.8828" y="2741.1826">Tempo</text></g><g><title>Individuals API</title><rect fill="#FFFFFF" height="1685.8281" style="stroke:#000000;stroke-width:1;" width="10" x="415.6914" y="210.3047"/></g><g><title>Person Service</title><rect fill="#FFFFFF" height="481.6563" style="stroke:#000000;stroke-width:1;" width="10" x="691.0977" y="429.6328"/></g><g><title>Person Service</title><rect fill="#FFFFFF" height="363.8594" style="stroke:#000000;stroke-width:1;" width="10" x="691.0977" y="2129.1328"/></g><g><title>Person Database</title><rect fill="#FFFFFF" height="235.3281" style="stroke:#000000;stroke-width:1;" width="10" x="970.1563" y="551.1641"/></g><g><title>Person Database</title><rect fill="#FFFFFF" height="205.0625" style="stroke:#000000;stroke-width:1;" width="10" x="970.1563" y="2208.5313"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="177.0625" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1075.3516"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="73.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1346.9453"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="262.4609" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1514.875"/></g><g><title>Keycloak</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#000000;stroke-width:1;" width="10" x="1091.0127" y="1990.3359"/></g><g><title>Keycloak Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1325.7983" y="1119.6172"/></g><path d="M91,143.9063 L91,168.9063 L1479,168.9063 L1479,153.9063 L1469,143.9063 L91,143.9063" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1469,143.9063 L1469,153.9063 L1479,153.9063 L1469,143.9063" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312.6348" x="624.2515" y="160.9731">Registration Flow with Distributed Tracing</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="403.6914,206.3047,413.6914,210.3047,403.6914,214.3047,407.6914,210.3047" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="118.9551" x2="409.6914" y1="210.3047" y2="210.3047"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="128.4551" y="197.6724">1</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.3325" x="187.6797" y="190.106">POST /v1/auth/registration</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="264.6909" x="141.5005" y="205.2388">{email, password, firstName, lastName}</text></g><path d="M351,223.3047 L351,263.3047 L488,263.3047 L488,233.3047 L478,223.3047 L351,223.3047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M478,223.3047 L478,233.3047 L488,233.3047 L478,223.3047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.7651" x="357" y="240.3716">Generate trace_id</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.2109" x="357" y="255.5044">(OpenTelemetry)</text><g class="message" data-entity-1="part2" data-entity-2="part7" id="msg2"><polygon fill="#000000" points="1440.0103,285.7031,1450.0103,289.7031,1440.0103,293.7031,1444.0103,289.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="425.6914" x2="1446.0103" y1="289.7031" y2="289.7031"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="856.8672" y="284.6372">2</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.9219" x="869.9126" y="284.6372">Start span: registration</text></g><path d="M324,302.7031 L324,372.7031 L517,372.7031 L517,312.7031 L507,302.7031 L324,302.7031" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M507,302.7031 L507,312.7031 L517,312.7031 L507,302.7031" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.6108" x="330" y="319.77">Validate request:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92.4092" x="330" y="334.9028">- email format</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.9429" x="330" y="350.0356">- password strength</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.0532" x="330" y="365.1685">- confirm_password match</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg3"><polygon fill="#000000" points="679.0977,425.6328,689.0977,429.6328,679.0977,433.6328,683.0977,429.6328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="425.6914" x2="685.0977" y1="429.6328" y2="429.6328"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="454.6321" y="409.4341">3</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.4546" x="507.6899" y="394.3013">POST /v1/persons</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="194.4795" x="467.6775" y="409.4341">{firstName, lastName, email}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="130.7617" x="499.5364" y="424.5669">header: traceparent</text></g><path d="M632,442.6328 L632,482.6328 L759,482.6328 L759,452.6328 L749,442.6328 L632,442.6328" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M749,442.6328 L749,452.6328 L759,452.6328 L749,442.6328" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.4946" x="638" y="459.6997">Start child span:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92.6123" x="638" y="474.8325">create_person</text><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg4"><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="743.0977" y1="509.0313" y2="509.0313"/><line style="stroke:#000000;stroke-width:1;" x1="743.0977" x2="743.0977" y1="509.0313" y2="522.0313"/><line style="stroke:#000000;stroke-width:1;" x1="702.0977" x2="743.0977" y1="522.0313" y2="522.0313"/><polygon fill="#000000" points="712.0977,518.0313,702.0977,522.0313,712.0977,526.0313,708.0977,522.0313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="708.0977" y="503.9653">4</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.9561" x="721.1431" y="503.9653">Generate user_uid (UUID)</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg5"><polygon fill="#000000" points="958.1563,547.1641,968.1563,551.1641,958.1563,555.1641,962.1563,551.1641" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="551.1641" y2="551.1641"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="759.8831" y="546.0981">5</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.4424" x="772.9285" y="546.0981">BEGIN TRANSACTION</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg6"><polygon fill="#000000" points="958.1563,606.5625,968.1563,610.5625,958.1563,614.5625,962.1563,610.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="610.5625" y2="610.5625"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="754.6431" y="590.3638">6</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.1226" x="781.0884" y="575.231">INSERT INTO users</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131.0347" x="776.6323" y="590.3638">(id=user_uid, email,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.9224" x="767.6885" y="605.4966">first_name, last_name)</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg7"><polygon fill="#000000" points="712.0977,635.6953,702.0977,639.6953,712.0977,643.6953,708.0977,639.6953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="706.0977" x2="969.1563" y1="639.6953" y2="639.6953"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="819.7256" y="634.6294">7</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="832.771" y="634.6294">OK</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg8"><polygon fill="#000000" points="958.1563,695.0938,968.1563,699.0938,958.1563,703.0938,962.1563,699.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="699.0938" y2="699.0938"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="750.6758" y="678.895">8</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.8569" x="763.7212" y="663.7622">INSERT INTO individuals</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.7734" x="781.2629" y="678.895">(user_id=user_uid,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.7622" x="790.7686" y="694.0278">status=ACTIVE)</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg9"><polygon fill="#000000" points="712.0977,724.2266,702.0977,728.2266,712.0977,732.2266,708.0977,728.2266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="706.0977" x2="969.1563" y1="728.2266" y2="728.2266"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="819.7256" y="723.1606">9</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="832.771" y="723.1606">OK</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg10"><polygon fill="#000000" points="958.1563,753.3594,968.1563,757.3594,958.1563,761.3594,962.1563,757.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="757.3594" y2="757.3594"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="797.823" y="752.2935">10</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="53.5171" x="819.9138" y="752.2935">COMMIT</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg11"><polygon fill="#000000" points="712.0977,782.4922,702.0977,786.4922,712.0977,790.4922,708.0977,786.4922" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="706.0977" x2="974.1563" y1="786.4922" y2="786.4922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="751.6333" y="781.4263">11</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.8965" x="773.7241" y="781.4263">Transaction committed</text></g><path d="M601,799.4922 L601,854.4922 L790,854.4922 L790,809.4922 L780,799.4922 L601,799.4922" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M780,799.4922 L780,809.4922 L790,809.4922 L780,799.4922" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.9409" x="607" y="816.5591">Envers audit:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.397" x="607" y="831.6919">user_aud, individuals_aud</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97.8872" x="607" y="846.8247">tables updated</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg12"><polygon fill="#000000" points="436.6914,907.2891,426.6914,911.2891,436.6914,915.2891,432.6914,911.2891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="430.6914" x2="695.0977" y1="911.2891" y2="911.2891"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="456.7449" y="891.0903">12</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="531.6006" y="875.9575">201 Created</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.3145" x="513.7827" y="891.0903">{userId: user_uid,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186.2085" x="478.8357" y="906.2231">email, firstName, lastName}</text></g><path d="M319,924.2891 L319,964.2891 L520,964.2891 L520,934.2891 L510,924.2891 L319,924.2891" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M510,924.2891 L510,934.2891 L520,934.2891 L510,924.2891" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180.8003" x="325" y="941.356">Person created successfully</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86.6709" x="325" y="956.4888">with user_uid</text><path d="M14,976.5547 L78.4429,976.5547 L78.4429,983.6875 L68.4429,993.6875 L14,993.6875 L14,976.5547" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="1728.6328" style="stroke:#000000;stroke-width:1;" width="1489.1377" x="14" y="976.5547"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="29" y="989.6216">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="212.5557" x="93.4429" y="988.7651">[Keycloak user creation succeeds]</text><g class="message" data-entity-1="part2" data-entity-2="part5" id="msg13"><polygon fill="#000000" points="1079.0127,1071.3516,1089.0127,1075.3516,1079.0127,1079.3516,1083.0127,1075.3516" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="425.6914" x2="1085.0127" y1="1075.3516" y2="1075.3516"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="624.3081" y="1040.02">13</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="245.9971" x="646.3989" y="1009.7544">POST /admin/realms/individuals/users</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="124.3696" x="707.2126" y="1024.8872">{username=email,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="182.0698" x="678.3625" y="1040.02">email, firstName, lastName,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.0215" x="722.3867" y="1055.1528">enabled=true,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.7598" x="693.5176" y="1070.2856">attributes: {user_uid}}</text></g><g class="message" data-entity-1="part5" data-entity-2="part6" id="msg14"><polygon fill="#000000" points="1313.7983,1115.6172,1323.7983,1119.6172,1313.7983,1123.6172,1317.7983,1119.6172" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1101.0127" x2="1319.7983" y1="1119.6172" y2="1119.6172"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1110.5127" y="1106.9849">14</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.5864" x="1144.6577" y="1099.4185">INSERT INTO user_entity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183.6948" x="1132.6035" y="1114.5513">(username, email, realm_id)</text></g><g class="message" data-entity-1="part6" data-entity-2="part5" id="msg15"><polygon fill="#000000" points="1112.0127,1144.75,1102.0127,1148.75,1112.0127,1152.75,1108.0127,1148.75" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1106.0127" x2="1329.7983" y1="1148.75" y2="1148.75"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1195.4814" y="1143.6841">15</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1217.5723" y="1143.6841">OK</text></g><g class="message" data-entity-1="part5" data-entity-2="part6" id="msg16"><polygon fill="#000000" points="1318.7983,1204.1484,1328.7983,1208.1484,1318.7983,1212.1484,1322.7983,1208.1484" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1101.0127" x2="1324.7983" y1="1208.1484" y2="1208.1484"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1115.428" y="1187.9497">16</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.5532" x="1137.6743" y="1172.8169">INSERT INTO user_attribute</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.8643" x="1137.5188" y="1187.9497">(user_id, name="user_uid",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.4312" x="1173.7354" y="1203.0825">value=user_uid)</text></g><g class="message" data-entity-1="part5" data-entity-2="part2" id="msg17"><polygon fill="#000000" points="436.6914,1248.4141,426.6914,1252.4141,436.6914,1256.4141,432.6914,1252.4141" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="430.6914" x2="1095.0127" y1="1252.4141" y2="1252.4141"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="643.6357" y="1239.7817">17</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="731.5581" y="1232.2153">201 Created</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="212.3418" x="665.7266" y="1247.3481">Location: .../users/{keycloak_id}</text></g><path d="M336,1265.4141 L336,1305.4141 L504,1305.4141 L504,1275.4141 L494,1265.4141 L336,1265.4141" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M494,1265.4141 L494,1275.4141 L504,1275.4141 L494,1265.4141" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="144.8472" x="342" y="1282.481">Keycloak user created</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.5068" x="342" y="1297.6138">with user_uid attribute</text><g class="message" data-entity-1="part2" data-entity-2="part5" id="msg18"><polygon fill="#000000" points="1079.0127,1342.9453,1089.0127,1346.9453,1079.0127,1350.9453,1083.0127,1346.9453" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="425.6914" x2="1085.0127" y1="1346.9453" y2="1346.9453"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="523.8374" y="1334.313">18</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="446.9385" x="545.9282" y="1326.7466">POST /admin/realms/individuals/users/{keycloak_id}/reset-password</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="243.2866" x="647.7542" y="1341.8794">{value=password, temporary=false}</text></g><g class="message" data-entity-1="part5" data-entity-2="part6" id="msg19"><polygon fill="#000000" points="1318.7983,1387.2109,1328.7983,1391.2109,1318.7983,1395.2109,1322.7983,1391.2109" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1101.0127" x2="1324.7983" y1="1391.2109" y2="1391.2109"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1140.7583" y="1378.5786">19</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.8115" x="1166.0452" y="1371.0122">UPDATE credential</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.2036" x="1162.8491" y="1386.145">SET password_hash</text></g><g class="message" data-entity-1="part5" data-entity-2="part2" id="msg20"><polygon fill="#000000" points="436.6914,1416.3438,426.6914,1420.3438,436.6914,1424.3438,432.6914,1420.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="430.6914" x2="1095.0127" y1="1420.3438" y2="1420.3438"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="698.5779" y="1415.2778">20</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.4575" x="720.6687" y="1415.2778">204 No Content</text></g><path d="M326,1433.3438 L326,1458.3438 L515,1458.3438 L515,1443.3438 L505,1433.3438 L326,1433.3438" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M505,1433.3438 L505,1443.3438 L515,1443.3438 L505,1433.3438" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.251" x="332" y="1450.4106">Password set successfully</text><g class="message" data-entity-1="part2" data-entity-2="part5" id="msg21"><polygon fill="#000000" points="1079.0127,1510.875,1089.0127,1514.875,1079.0127,1518.875,1083.0127,1514.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="425.6914" x2="1085.0127" y1="1514.875" y2="1514.875"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="564.5735" y="1494.6763">21</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="365.4663" x="586.6643" y="1479.5435">POST /realms/individuals/protocol/openid-connect/token</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="155.6826" x="691.5562" y="1494.6763">{grant_type=password,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="190.4487" x="674.1731" y="1509.8091">username=email, password}</text></g><g class="message" data-entity-1="part5" data-entity-2="part6" id="msg22"><polygon fill="#000000" points="1318.7983,1555.1406,1328.7983,1559.1406,1318.7983,1563.1406,1322.7983,1559.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1101.0127" x2="1324.7983" y1="1559.1406" y2="1559.1406"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1115.666" y="1546.5083">22</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.3882" x="1137.7568" y="1538.9419">SELECT * FROM user_entity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.1885" x="1144.8567" y="1554.0747">WHERE username=email</text></g><g class="message" data-entity-1="part6" data-entity-2="part5" id="msg23"><polygon fill="#000000" points="1112.0127,1584.2734,1102.0127,1588.2734,1112.0127,1592.2734,1108.0127,1588.2734" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1106.0127" x2="1329.7983" y1="1588.2734" y2="1588.2734"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1169.3481" y="1583.2075">23</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="71.0239" x="1191.439" y="1583.2075">User found</text></g><g class="message" data-entity-1="part5" data-entity-2="part5" id="msg24"><line style="stroke:#000000;stroke-width:1;" x1="1101.0127" x2="1143.0127" y1="1617.4063" y2="1617.4063"/><line style="stroke:#000000;stroke-width:1;" x1="1143.0127" x2="1143.0127" y1="1617.4063" y2="1630.4063"/><line style="stroke:#000000;stroke-width:1;" x1="1102.0127" x2="1143.0127" y1="1630.4063" y2="1630.4063"/><polygon fill="#000000" points="1112.0127,1626.4063,1102.0127,1630.4063,1112.0127,1634.4063,1108.0127,1630.4063" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1108.0127" y="1612.3403">24</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.8257" x="1130.1035" y="1612.3403">Validate password hash</text></g><g class="message" data-entity-1="part5" data-entity-2="part5" id="msg25"><line style="stroke:#000000;stroke-width:1;" x1="1101.0127" x2="1143.0127" y1="1689.8047" y2="1689.8047"/><line style="stroke:#000000;stroke-width:1;" x1="1143.0127" x2="1143.0127" y1="1689.8047" y2="1702.8047"/><line style="stroke:#000000;stroke-width:1;" x1="1102.0127" x2="1143.0127" y1="1702.8047" y2="1702.8047"/><polygon fill="#000000" points="1112.0127,1698.8047,1102.0127,1702.8047,1112.0127,1706.8047,1108.0127,1702.8047" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1108.0127" y="1669.606">25</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.5781" x="1138.2539" y="1654.4731">Generate JWT tokens:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.1387" x="1135.4736" y="1669.606">- access_token (5 min)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.8789" x="1130.1035" y="1684.7388">- refresh_token (30 min)</text></g><g class="message" data-entity-1="part5" data-entity-2="part2" id="msg26"><polygon fill="#000000" points="436.6914,1773.3359,426.6914,1777.3359,436.6914,1781.3359,432.6914,1777.3359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="430.6914" x2="1095.0127" y1="1777.3359" y2="1777.3359"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="694.8074" y="1749.5708">26</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="748.0461" y="1726.8716">200 OK</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.5249" x="722.135" y="1742.0044">{access_token,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="93.7231" x="725.0359" y="1757.1372">refresh_token,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.9985" x="716.8982" y="1772.27">expires_in=300}</text></g><g class="message" data-entity-1="part2" data-entity-2="part7" id="msg27"><polygon fill="#000000" points="1440.0103,1817.6016,1450.0103,1821.6016,1440.0103,1825.6016,1444.0103,1821.6016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="425.6914" x2="1446.0103" y1="1821.6016" y2="1821.6016"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="855.8706" y="1808.9692">27</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.8696" x="877.9614" y="1801.4028">End span: registration</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.708" x="878.5422" y="1816.5356">(duration, status=OK)</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg28"><polygon fill="#000000" points="129.9551,1892.1328,119.9551,1896.1328,129.9551,1900.1328,125.9551,1896.1328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="123.9551" x2="419.6914" y1="1896.1328" y2="1896.1328"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="181.3206" y="1868.3677">28</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="257.0173" y="1845.6685">200 OK</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.5249" x="231.1062" y="1860.8013">{access_token,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="93.7231" x="234.0071" y="1875.9341">refresh_token,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.9146" x="203.4114" y="1891.0669">expires_in, token_type}</text></g><path d="M24,1909.1328 L24,1949.1328 L213,1949.1328 L213,1919.1328 L203,1909.1328 L24,1909.1328" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M203,1909.1328 L203,1919.1328 L213,1919.1328 L203,1909.1328" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168.8286" x="30" y="1926.1997">Registration complete!</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.8105" x="30" y="1941.3325">User receives JWT tokens</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="14" x2="1503.1377" y1="1955.3984" y2="1955.3984"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="340.146" x="19" y="1965.6089">[Keycloak user creation fails (409 Conflict / 500 Error)]</text><g class="message" data-entity-1="part2" data-entity-2="part5" id="msg29"><polygon fill="#000000" points="1079.0127,1986.3359,1089.0127,1990.3359,1079.0127,1994.3359,1083.0127,1990.3359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="420.6914" x2="1085.0127" y1="1990.3359" y2="1990.3359"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="621.8081" y="1985.27">29</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="245.9971" x="643.8989" y="1985.27">POST /admin/realms/individuals/users</text></g><g class="message" data-entity-1="part5" data-entity-2="part2" id="msg30"><polygon fill="#000000" points="431.6914,2030.6016,421.6914,2034.6016,431.6914,2038.6016,427.6914,2034.6016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="425.6914" x2="1095.0127" y1="2034.6016" y2="2034.6016"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="621.4263" y="2021.9692">30</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="170.3838" x="684.2056" y="2014.4028">409 Conflict / 500 Error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="251.7607" x="643.5171" y="2029.5356">{error: "User exists" / "Internal error"}</text></g><path d="M277,2047.6016 L277,2087.6016 L562,2087.6016 L562,2057.6016 L552,2047.6016 L277,2047.6016" fill="#FFA500" style="stroke:#000000;stroke-width:1;"/><path d="M552,2047.6016 L552,2057.6016 L562,2057.6016 L552,2047.6016" fill="#FFA500" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="11.6543" x="283" y="2064.6685">&#9888;&#65039;</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117.7935" x="298.7866" y="2064.6685">Keycloak failed!</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="264.3926" x="283" y="2079.8013">Initiating COMPENSATING TRANSACTION</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg31"><polygon fill="#000000" points="679.0977,2125.1328,689.0977,2129.1328,679.0977,2133.1328,683.0977,2129.1328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="420.6914" x2="685.0977" y1="2129.1328" y2="2129.1328"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="430.1914" y="2116.5005">31</text><text fill="#FF0000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229.3154" x="452.2822" y="2108.9341">DELETE /v1/persons/{user_uid}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="130.7617" x="501.5591" y="2124.0669">header: traceparent</text></g><path d="M632,2142.1328 L632,2182.1328 L759,2182.1328 L759,2152.1328 L749,2142.1328 L632,2142.1328" fill="#FFA500" style="stroke:#000000;stroke-width:1;"/><path d="M749,2142.1328 L749,2152.1328 L759,2152.1328 L749,2142.1328" fill="#FFA500" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.4946" x="638" y="2159.1997">Start child span:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.4766" x="638" y="2174.3325">rollback_person</text><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg32"><polygon fill="#000000" points="958.1563,2204.5313,968.1563,2208.5313,958.1563,2212.5313,962.1563,2208.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="2208.5313" y2="2208.5313"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="755.3604" y="2203.4653">32</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.4424" x="777.4512" y="2203.4653">BEGIN TRANSACTION</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg33"><polygon fill="#000000" points="958.1563,2248.7969,968.1563,2252.7969,958.1563,2256.7969,962.1563,2252.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="2252.7969" y2="2252.7969"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="713.0977" y="2240.1646">33</text><text fill="#FF0000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.9214" x="763.7117" y="2232.5981">DELETE FROM individuals</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="222.9678" x="735.1885" y="2247.731">WHERE user_id=user_uid&lt;/color&gt;</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg34"><polygon fill="#000000" points="712.0977,2277.9297,702.0977,2281.9297,712.0977,2285.9297,708.0977,2281.9297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="706.0977" x2="969.1563" y1="2281.9297" y2="2281.9297"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="815.2029" y="2276.8638">34</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="837.2937" y="2276.8638">OK</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg35"><polygon fill="#000000" points="958.1563,2322.1953,968.1563,2326.1953,958.1563,2330.1953,962.1563,2326.1953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="2326.1953" y2="2326.1953"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="730.5251" y="2313.563">35</text><text fill="#FF0000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131.187" x="781.0789" y="2305.9966">DELETE FROM users</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="188.1128" x="752.616" y="2321.1294">WHERE id=user_uid&lt;/color&gt;</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg36"><polygon fill="#000000" points="712.0977,2351.3281,702.0977,2355.3281,712.0977,2359.3281,708.0977,2355.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="706.0977" x2="969.1563" y1="2355.3281" y2="2355.3281"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="815.2029" y="2350.2622">36</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="837.2937" y="2350.2622">OK</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg37"><polygon fill="#000000" points="958.1563,2380.4609,968.1563,2384.4609,958.1563,2388.4609,962.1563,2384.4609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.0977" x2="964.1563" y1="2384.4609" y2="2384.4609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="797.823" y="2379.395">37</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="53.5171" x="819.9138" y="2379.395">COMMIT</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg38"><polygon fill="#000000" points="712.0977,2409.5938,702.0977,2413.5938,712.0977,2417.5938,708.0977,2413.5938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="706.0977" x2="974.1563" y1="2413.5938" y2="2413.5938"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="751.6333" y="2408.5278">38</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.8965" x="773.7241" y="2408.5278">Transaction committed</text></g><path d="M598,2426.5938 L598,2466.5938 L792,2466.5938 L792,2436.5938 L782,2426.5938 L598,2426.5938" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M782,2426.5938 L782,2436.5938 L792,2436.5938 L782,2426.5938" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.9409" x="604" y="2443.6606">Envers audit:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="173.3164" x="604" y="2458.7935">DEL records in _aud tables</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg39"><polygon fill="#000000" points="431.6914,2488.9922,421.6914,2492.9922,431.6914,2496.9922,427.6914,2492.9922" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="425.6914" x2="695.0977" y1="2492.9922" y2="2492.9922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="496.1204" y="2487.9263">39</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.4575" x="518.2112" y="2487.9263">204 No Content</text></g><path d="M332,2505.9922 L332,2545.9922 L508,2545.9922 L508,2515.9922 L498,2505.9922 L332,2505.9922" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M498,2505.9922 L498,2515.9922 L508,2515.9922 L498,2505.9922" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="7.8013" x="338" y="2523.0591">&#9989;</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142.873" x="349.9336" y="2523.0591">Rollback successful</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="155.2192" x="338" y="2538.1919">Person deleted from DB</text><g class="message" data-entity-1="part2" data-entity-2="part7" id="msg40"><polygon fill="#000000" points="1440.0103,2583.5234,1450.0103,2587.5234,1440.0103,2591.5234,1444.0103,2587.5234" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="420.6914" x2="1446.0103" y1="2587.5234" y2="2587.5234"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="840.5579" y="2574.8911">40</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.8696" x="875.4614" y="2567.3247">End span: registration</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="118.8789" x="862.6487" y="2582.4575">(duration, status=</text><text fill="#FF0000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="45.5444" x="981.5276" y="2582.4575">ERROR</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="1027.072" y="2582.4575">)</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg41"><polygon fill="#000000" points="129.9551,2642.9219,119.9551,2646.9219,129.9551,2650.9219,125.9551,2646.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="123.9551" x2="419.6914" y1="2646.9219" y2="2646.9219"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="166.7432" y="2626.7231">41</text><text fill="#FF0000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.0693" x="188.834" y="2611.5903">500 Internal Server Error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.2549" x="191.7412" y="2626.7231">{error: "Registration failed:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="107.7959" x="226.9707" y="2641.856">keycloak error"}</text></g><path d="M37,2659.9219 L37,2699.9219 L200,2699.9219 L200,2669.9219 L190,2659.9219 L37,2659.9219" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><path d="M190,2659.9219 L190,2669.9219 L200,2669.9219 L190,2659.9219" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142.4985" x="43" y="2676.9888">Registration failed!</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.4697" x="43" y="2692.1216">No orphaned data</text><?plantuml-src hLVDSXf74Bxp56rSbH8n63cs3w4aLKcmLeWie03P5wgeqKu3KrfcDpEpabKkZZdddieXZv7dyGla5T8p-yCkVr7iw22McTx-_VhhvfbPu18X2fYG5NqdPCGKMu927OLIupLgpUPuWK7uSAvK-016nLWGrFXBZDBF1Cy3CPVWepIe2b8NuQS1urp8ERmwhbICC072ZKO5GvmBRHGp8fJmZgp0Wp0BwDX3SHiRv31MpBTlVWVjS1cXr2HCN-cO7dtxOgL2dw5o6YjaqGXVH4mQg7Ob5_U2nopGS3xeLe6vpxBG09KcwoDKzy979pCOLJWpx9PfpEyxwO4Jw5oKTLpXen-4xCvTNhKBRsStvVUlDXMCSHc5xiezKKYn2MMylAMGAZ8q2E4z9Y7MKn60azkpfoVmf7bxLa79mMghL5pw6sSs7V3YHGi6_T4OclUlccHuqLG5jHFv6PTC17M8cDOFeU9rc0cbJOyjiGu1IvvMHJzjaW4kKIBfG48Dyt4gE9qTzQc6Omm8TaOzrWeUMK_88HTS2qQ6qWEQijE2eZVRLZwmG71hHLamQjEYimOubs4MgYKpxY1p7aWJohbPk5C_b1JBSfhVahY_sFPgC2fdANAWq9IR7Qce9zPN4xb0nb6raWHGmQapYW4GpY2Dr5-8W2Vnqfcla2AQ9bOAtf0RpfdMEhSn5N8Q2mv7DpVTJYsJwLmuXo-yosuFniFptkYyFUxsU-lx5dHx8syufezntwcXS8u4Fyqqfc7K9zB5E9LvaEwnLY4RZTIT_jK-nMBTWwJUwIxQc4Xjc8drgNNlWtT0QRj_VTqTh-_ferMa0QhbSYaCGNuhnPwaHmqiviB1mrcdR_MYT_Q0xgXB0zGGHnPJV2FtQSDOopySluAsAnCd55YDNTw2GbnfqpoXLU0vyUR2p1MY90zImaamG9Y8VP_eTHO7mIFTklxEp1JSOu4fwe6SUAnieimcoMb3haaJWFkN8logNK0uuqiXYGLOiDJDGewQAKnSl1O4fnb4zaThBwLDAZ-rquE-CfEIasx1vooKrMhj4lbYFKenl0dJANMHC8yfckIwuUhWF2PyrH8rALQikeQ3qxQ57UfpzzPuhOCBjfevMwKexbaGOmxaMbdtFg2y3trNXnQyVFaooMRpyrrQAZ9KIC8XY3WpsmL6djwLG09vGEusXymt8A3iCubfD8sCGmaUIMxMyy9OKbTCFPxEI0UkDcjmC-YSZpqR1BV5PS54ZhnnpjdJ1TEBtRbz0xsGDWFQEAHvUku6-J10izbWJytGZjn4AZIX7mRDa8QSu0sQBX9zqpJX7TevEYUsCbFp61LoCv4RlPH7lTe9rv7ttckFuNjuD-nVb_lXuq_Uq8Eoker6Q2LxrooC9TzIJxVvCCq7Ofxw3Sby0FtySGmkGDsQo0OmbyofEu6Zjq0mgjbpXJE2oIAxU7tiRWvqpJ4rBEMig8-ILL9ZgULJ9EXWAkJfw-FZrLR9qdN2atp7Ca4DpkFaiGxf7EfVrJQKa9PaM_egj-f9SbpLTtQtqxqDqStbZgPR5A31PswHIsJSgmfz5FSqijQ5AAEuWjHoy3mIycxVL9WHKZGSlJd-qVRIB12-WIQyfM0zMljLxLkuObTrARXzjcnuTkMqposekX3n4-L1LqcCLdfZuHs04wZkvqkY6pd7D55VVl_pxxz-isRp1DYGaHUpsPM2gCVzkg1TO-3HoZJkzYvBszD1UaYNHB9oGYH0xXETdNMeNudQ2ajZSptpJffEy2m9UjUsk2CyCbEERjS6QVzK60ItpB_BziZTpl_BlhWbHm5kHUUugBJfhRcekEvbyJg5vKtlwNRI7IInyDNAqtMo97jWfTnPXpJFc-kbq-czjvr93AefCM2NotIrF526_s6oVVdZLqSTQUaBmws0z7J3v6W9XSDCXKlxa_OWkFypaHQgvms7_M5MdaFqMcuTombvlzlVvoILSaInRNAkAF5bqjyqah9DvH1Z91ni6N8F-swp1HKdLD62IKgW_Rc_oRcI_mC0?></g></svg>